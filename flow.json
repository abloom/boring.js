[{"type":"tab","id":"8eb35af3.714ca8","label":"Sheet 1"},{"id":"9f41c368.60be4","type":"inject","name":"Tea Time Start","topic":"","payload":"Tea Time Start","payloadType":"string","repeat":"","crontab":"00 16 * * *","once":false,"x":466,"y":401.08332538604736,"z":"8eb35af3.714ca8","wires":[["ce22da99.31dd28"]]},{"id":"706ef0d5.8f911","type":"function","name":"Motion 1","func":"var payload = parseInt(msg.payload);\n\nif (payload === 1) {\n  return {\n    payload: \"Motion 1\",\n    weight: 100\n  };\n}","outputs":1,"x":594,"y":288.08332443237305,"z":"8eb35af3.714ca8","wires":[["36083803.c9f7c8"]]},{"id":"48150597.b7eafc","type":"function","name":"Motion 2","func":"var payload = parseInt(msg.payload);\n\nif (payload === 1) {\n  return {\n    payload: \"Motion 2\",\n    weight: 90\n  };\n}","outputs":1,"x":593,"y":346.08332443237305,"z":"8eb35af3.714ca8","wires":[["36083803.c9f7c8"]]},{"id":"424ec2ca.bdb13c","type":"inject","name":"Tea Time End","topic":"","payload":"Team Time End","payloadType":"string","repeat":"","crontab":"00 17 * * *","once":false,"x":463,"y":450.08331298828125,"z":"8eb35af3.714ca8","wires":[["ce22da99.31dd28"]]},{"id":"57c3c64a.a83c38","type":"inject","name":"Idle Timer","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"*/1 9-17 * * *","once":false,"x":450.8332748413086,"y":509.3636474609375,"z":"8eb35af3.714ca8","wires":[["f93bcdba.06c43"]]},{"id":"91754112.6e8ac","type":"inject","name":"Simulate Pin 11","topic":"","payload":"1","payloadType":"string","repeat":"","crontab":"","once":false,"x":266.1969223022461,"y":287,"z":"8eb35af3.714ca8","wires":[["706ef0d5.8f911"]]},{"id":"a8cd403d.5732c","type":"function","name":"Completed Action","func":"context.global.lastCompletedAt = (new Date()).getTime();\ncontext.global.currentAction = null;\nreturn msg;","outputs":"0","x":1689.924217224121,"y":423.54547119140625,"z":"8eb35af3.714ca8","wires":[]},{"id":"f93bcdba.06c43","type":"function","name":"Idle Gate","func":"var lastCompletedAt = context.global.lastCompletedAt,\n    fifteenMin = 2 * 60 * 1000,\n    currentTime = parseInt(msg.payload),\n    action = context.global.currentAction;\n\n\nif (!lastCompletedAt\n    || (currentTime < lastCompletedAt + fifteenMin)) {\n  return {\n    payload: \"Idle\",\n    weight: 10\n  };\n}\n\nreturn null;","outputs":1,"x":610.3787460327148,"y":509.272705078125,"z":"8eb35af3.714ca8","wires":[["36083803.c9f7c8"]]},{"id":"fb6b2586.0494d8","type":"inject","name":"Simulate Pin 12","topic":"","payload":"1","payloadType":"string","repeat":"","crontab":"","once":false,"x":266.8332748413086,"y":345,"z":"8eb35af3.714ca8","wires":[["48150597.b7eafc"]]},{"id":"36083803.c9f7c8","type":"function","name":"Action Priority","func":"var action = context.global.currentAction;\n\nif (!action) {\n  return msg;\n}\n\nvar mWeight = parseInt(msg.weight),\n    aWeight = parseInt(msg.weight);\n\nif (mWeight > aWeight) {\n  return msg;\n}\n\nreturn null;","outputs":1,"x":983.8332748413086,"y":424,"z":"8eb35af3.714ca8","wires":[["17899af9.e87665","ef2f4b0e.10d0b8"]]},{"id":"20f2976e.df0d68","type":"delay","name":"Simulate Video","pauseType":"delay","timeout":"30","timeoutUnits":"seconds","rate":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1419.8332748413086,"y":424,"z":"8eb35af3.714ca8","wires":[["a8cd403d.5732c"]]},{"id":"17899af9.e87665","type":"function","name":"Start Action","func":"context.global.currentAction = msg;\nreturn msg;","outputs":1,"x":1204.8332748413086,"y":424,"z":"8eb35af3.714ca8","wires":[["20f2976e.df0d68"]]},{"id":"ef2f4b0e.10d0b8","type":"function","name":"Kill Current Action","func":"var action = context.global.currentAction;\n\nif (!action) {\n  return null;\n}\n\nreturn msg;","outputs":1,"x":1222.8332748413086,"y":364,"z":"8eb35af3.714ca8","wires":[[]]},{"id":"ce22da99.31dd28","type":"function","name":"Tea Time Weight","func":"msg.weight = 30;\nreturn msg;","outputs":1,"x":678.8332748413086,"y":424,"z":"8eb35af3.714ca8","wires":[["36083803.c9f7c8"]]},{"id":"dc21caf.f23de38","type":"inject","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":305,"y":105,"z":"8eb35af3.714ca8","wires":[["1cc44a64.e33bb6"]]},{"id":"1cc44a64.e33bb6","type":"function","name":"","func":"msg.videos = context.global.videos;\nreturn msg;","outputs":1,"x":494,"y":128,"z":"8eb35af3.714ca8","wires":[["461ad332.b9e52c"]]},{"id":"461ad332.b9e52c","type":"debug","name":"","active":true,"console":"true","complete":"true","x":663,"y":108,"z":"8eb35af3.714ca8","wires":[]}]